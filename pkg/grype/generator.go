package grype

import (
	"fmt"
	"os"
	"os/exec"
	"path/filepath"
)

const (
	JSON  = "json"
	TABLE = "table"
)

func GenerateVulTable(image string, source string, format string) {
	cmd := exec.Command("grype", filepath.Join(source, image), "-o", format)
	out, err := cmd.Output()
	if err != nil {
		fmt.Println("Error generating vulnerability table", err)
	} else {
		fmt.Println(filepath.Join("vul", image+".txt"))
		os.WriteFile(filepath.Join("vul", image+".txt"), out, 0666)
	}
}
