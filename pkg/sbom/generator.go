package sbom

import (
	"fmt"
	"os"
	"os/exec"
	"path/filepath"
)

const (
	SPDX_JSON = "spdx-json"
	JSON      = "json"
	TEXT      = "text"
	GITHUB    = "github"
)

func GenerateSBOM(image string, source string, format string) {
	cmd := exec.Command("syft", "packages", filepath.Join(source, image), "-o", format)
	out, err := cmd.Output()
	if err != nil {
		fmt.Println("Error generating SBOM: ", err)
	} else {
		fmt.Println(filepath.Join("bom", image+".json"))
		os.WriteFile(filepath.Join("bom", image+".json"), out, 0666)
	}

}
