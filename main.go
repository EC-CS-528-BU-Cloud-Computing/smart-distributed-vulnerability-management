package main

import (
	// "errors"

	"fmt"

	"github.com/everfix/pkg/parser"
	"github.com/everfix/pkg/sbom"
)

func main() {
	// example on how to get the base image
	// parse base image
	// example: get the dependency trees for image main and its base image
	fmt.Println("Example for establishing graph for image: main")
	sbom.GenerateSBOM("main:latest", "docker.io/library", sbom.SPDX_JSON)
	fmt.Println("\nParsing dockerfile to retrieve main's base image")
	baseImage, err := parser.GetBaseImage("dockerfile/Dockerfile")
	// print the name of base
	if err == nil {
		fmt.Println("\nGet base image")
		fmt.Println("Name: ", baseImage.Name)
		fmt.Println("Tag: ", baseImage.Tag)
	}
	// generate sbom for the base image and the image
	imageStr := baseImage.Name + ":" + baseImage.Tag
	sbom.GenerateSBOM(imageStr, "docker.io/library", sbom.SPDX_JSON)
	fmt.Println("\nGenerating dependency tree for main")
	parser.Parse("bom/")
}
