package main

import (
	// "errors"

	"fmt"

	"github.com/everfix/pkg/parser"
	"github.com/everfix/pkg/sbom"
	"github.com/guacsec/guac/cmd/guacone/cmd"
)

func main() {
	// example on how to get the base image
	// parse base image
	baseImage, err := parser.GetBaseImage("dockerfile/Dockerfile")
	// print the name of base
	if err == nil {
		fmt.Println("\nBase image: ")
		fmt.Println("Name: ", baseImage.Name)
		fmt.Println("Tag: ", baseImage.Tag)
	}
	// generate sbom for the base image
	imageStr := baseImage.Name + ":" + baseImage.Tag
	sbom.GenerateSBOM(imageStr, "docker.io/library", sbom.SPDX_JSON)
	cmd.Execute()

}
